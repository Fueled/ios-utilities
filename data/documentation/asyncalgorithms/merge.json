{"schemaVersion":{"minor":3,"major":0,"patch":0},"hierarchy":{"paths":[["doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms"]]},"primaryContentSections":[{"kind":"content","content":[{"anchor":"overview","text":"Overview","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"["},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Sources\/AsyncAlgorithms\/Merge\/AsyncMerge2Sequence.swift"},{"type":"text","text":", "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Sources\/AsyncAlgorithms\/Merge\/AsyncMerge3Sequence.swift"},{"type":"text","text":" |"},{"type":"text","text":" "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Tests\/AsyncAlgorithmsTests\/TestMerge.swift"},{"type":"text","text":"]"}]},{"syntax":"swift","type":"codeListing","code":["let appleFeed = URL(string: \"http:\/\/www.example.com\/ticker?symbol=AAPL\")!.lines.map { \"AAPL: \" + $0 }","let nasdaqFeed = URL(string:\"http:\/\/www.example.com\/ticker?symbol=^IXIC\")!.lines.map { \"^IXIC: \" + $0 }","","for try await ticker in merge(appleFeed, nasdaqFeed) {","  print(ticker)","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Given some sample inputs the following merged events can be expected."}]},{"type":"table","header":"row","rows":[[[{"inlineContent":[{"text":"Timestamp","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"appleFeed","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"nasdaqFeed","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"merged output"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"11:40 AM"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"173.91"}]}],[{"type":"paragraph","inlineContent":[]}],[{"inlineContent":[{"type":"text","text":"AAPL: 173.91"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"text":"12:25 AM","type":"text"}]}],[{"type":"paragraph","inlineContent":[]}],[{"type":"paragraph","inlineContent":[{"text":"14236.78","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"^IXIC: 14236.78"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"12:40 AM"}]}],[{"type":"paragraph","inlineContent":[]}],[{"type":"paragraph","inlineContent":[{"text":"14218.34","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"^IXIC: 14218.34","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"1:15 PM","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"173.00","type":"text"}]}],[{"type":"paragraph","inlineContent":[]}],[{"type":"paragraph","inlineContent":[{"text":"AAPL: 173.00","type":"text"}]}]]]},{"anchor":"Detailed-Design","text":"Detailed Design","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"This function family and the associated family of return types are prime candidates for variadic generics. Until that proposal is accepted, these will be implemented in terms of two- and three-base sequence cases."}]},{"syntax":"swift","type":"codeListing","code":["public func merge<Base1: AsyncSequence, Base2: AsyncSequence>(_ base1: Base1, _ base2: Base2) -> AsyncMerge2Sequence<Base1, Base2>","","public func merge<Base1: AsyncSequence, Base2: AsyncSequence, Base3: AsyncSequence>(_ base1: Base1, _ base2: Base2, _ base3: Base3) -> AsyncMerge3Sequence<Base1, Base2, Base3>","","public struct AsyncMerge2Sequence<Base1: AsyncSequence, Base2: AsyncSequence>: Sendable","  where","    Base1.Element == Base2.Element,","    Base1: Sendable, Base2: Sendable,","    Base1.Element: Sendable, Base2.Element: Sendable,","    Base1.AsyncIterator: Sendable, Base2.AsyncIterator: Sendable {","  public typealias Element = Base1.Element","","  public struct Iterator: AsyncIteratorProtocol {","    public mutating func next() async rethrows -> Element?","  }","","  public func makeAsyncIterator() -> Iterator","}","","public struct AsyncMerge3Sequence<Base1: AsyncSequence, Base2: AsyncSequence, Base3: AsyncSequence>: Sendable","  where","    Base1.Element == Base2.Element, Base1.Element == Base3.Element,","    Base1: Sendable, Base2: Sendable, Base3: Sendable","    Base1.Element: Sendable, Base2.Element: Sendable, Base3.Element: Sendable","    Base1.AsyncIterator: Sendable, Base2.AsyncIterator: Sendable, Base3.AsyncIterator: Sendable {","  public typealias Element = Base1.Element","","  public struct Iterator: AsyncIteratorProtocol {","    public mutating func next() async rethrows -> Element?","  }","","  public func makeAsyncIterator() -> Iterator","}",""]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"codeVoice","code":"merge(_:...)"},{"type":"text","text":" function takes two or more asynchronous sequences as arguments and produces an "},{"type":"codeVoice","code":"AsyncMergeSequence"},{"type":"text","text":" which is an asynchronous sequence."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Since the bases comprising the "},{"type":"codeVoice","code":"AsyncMergeSequence"},{"type":"text","text":" must be iterated concurrently to produce the latest value,  those sequences must be able to be sent to child tasks. This means that a prerequisite of the bases must be that the base asynchronous sequences, their iterators, and the elements they produce must be "},{"type":"codeVoice","code":"Sendable"},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"When iterating a "},{"type":"codeVoice","code":"AsyncMergeSequence"},{"type":"text","text":", the sequence terminates when all of the base asynchronous sequences terminate, since this means there is no potential for any further elements to be produced."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The throwing behavior of "},{"type":"codeVoice","code":"AsyncMergeSequence"},{"type":"text","text":" is that if any of the bases throw, then the composed asynchronous sequence throws on its iteration. If at any point an error is thrown by any base, the other iterations are cancelled and the thrown error is immediately thrown to the consuming iteration."}]},{"anchor":"Naming","text":"Naming","type":"heading","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"Since the inherent behavior of "},{"type":"codeVoice","code":"merge(_:...)"},{"type":"text","text":" merges values from multiple streams into a singular asynchronous sequence, the naming is intended to be quite literal. There are precedent terms of art in other frameworks and libraries (listed in the comparison section). Other naming takes the form of “withLatestFrom”. This was disregarded since the “with” prefix is often most associated with the passing of a closure and some sort of contextual concept; "},{"type":"codeVoice","code":"withUnsafePointer"},{"type":"text","text":" or "},{"type":"codeVoice","code":"withUnsafeContinuation"},{"type":"text","text":" are prime examples."}]},{"type":"heading","text":"Comparison with other libraries","anchor":"Comparison-with-other-libraries","level":3},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"ReactiveX"}],"type":"strong"},{"text":" ReactiveX has an ","type":"text"},{"isActive":true,"identifier":"https:\/\/reactivex.io\/documentation\/operators\/merge.html","type":"reference"},{"text":" as a top level function for merging Observables.","type":"text"}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Combine","type":"text"}],"type":"strong"},{"text":" Combine has an ","type":"text"},{"isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/combine\/publisher\/merge(with:)-7qt71\/","type":"reference"},{"text":" as an operator style method for merging Publishers.","type":"text"}]}]}],"variants":[{"paths":["\/documentation\/asyncalgorithms\/merge"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Merge","interfaceLanguage":"swift"},"sections":[],"metadata":{"modules":[{"name":"AsyncAlgorithms"}],"role":"article","roleHeading":"Article","title":"Merge"},"abstract":[{"text":"Merges two or more asynchronous sequences sharing the same element type into one singular asynchronous sequence.","type":"text"}],"seeAlsoSections":[{"anchor":"Getting-Started","title":"Getting Started","identifiers":["doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/AdjacentPairs","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/BufferedBytes","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Chain","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Channel","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Chunked","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Collections","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/CombineLatest","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Compacted","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Debounce","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Effects","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Intersperse","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Joined","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Lazy","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Reductions","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/RemoveDuplicates"],"generated":true}],"kind":"article","references":{"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Reductions":{"title":"Reductions","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Reductions","url":"\/documentation\/asyncalgorithms\/reductions","abstract":[],"kind":"article"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Compacted":{"title":"Compacted","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Compacted","url":"\/documentation\/asyncalgorithms\/compacted","abstract":[],"kind":"article"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Intersperse":{"title":"Intersperse","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Intersperse","url":"\/documentation\/asyncalgorithms\/intersperse","abstract":[{"type":"text","text":"Places a given value in between each element of the asynchronous sequence."}],"kind":"article"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/BufferedBytes":{"title":"AsyncBufferedByteIterator","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/BufferedBytes","url":"\/documentation\/asyncalgorithms\/bufferedbytes","abstract":[{"type":"text","text":"Provides a highly efficient iterator useful for iterating byte sequences derived from asynchronous read functions."}],"kind":"article"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms":{"type":"topic","abstract":[{"type":"strong","inlineContent":[{"type":"text","text":"Swift Async Algorithms"}]},{"type":"text","text":" is an open-source package of asynchronous sequence and advanced algorithms that involve concurrency, along with their related types."}],"title":"AsyncAlgorithms","kind":"symbol","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms","role":"collection","url":"\/documentation\/asyncalgorithms"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Effects":{"title":"Effects","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Effects","url":"\/documentation\/asyncalgorithms\/effects","abstract":[{"type":"text","text":"Lists the effects of all async algorithms."}],"kind":"article"},"https://reactivex.io/documentation/operators/merge.html":{"title":"API definition of Merge","titleInlineContent":[{"text":"API definition of Merge","type":"text"}],"url":"https:\/\/reactivex.io\/documentation\/operators\/merge.html","identifier":"https:\/\/reactivex.io\/documentation\/operators\/merge.html","type":"link"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Channel":{"title":"Channel","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Channel","url":"\/documentation\/asyncalgorithms\/channel","abstract":[],"kind":"article"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/AdjacentPairs":{"title":"AdjacentPairs","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/AdjacentPairs","url":"\/documentation\/asyncalgorithms\/adjacentpairs","abstract":[],"kind":"article"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/CombineLatest":{"title":"Combine Latest","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/CombineLatest","url":"\/documentation\/asyncalgorithms\/combinelatest","abstract":[{"type":"text","text":"Combines the latest values produced from two or more asynchronous sequences into an asynchronous sequence of tuples."}],"kind":"article"},"https://developer.apple.com/documentation/combine/publisher/merge(with:)-7qt71/":{"title":"API definition of merge(with:)","titleInlineContent":[{"text":"API definition of merge(with:)","type":"text"}],"url":"https:\/\/developer.apple.com\/documentation\/combine\/publisher\/merge(with:)-7qt71\/","identifier":"https:\/\/developer.apple.com\/documentation\/combine\/publisher\/merge(with:)-7qt71\/","type":"link"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Chunked":{"title":"Chunked","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Chunked","url":"\/documentation\/asyncalgorithms\/chunked","abstract":[],"kind":"article"},"https://github.com/apple/swift-async-algorithms/blob/main/Sources/AsyncAlgorithms/Merge/AsyncMerge2Sequence.swift":{"titleInlineContent":[{"text":"Source","type":"text"}],"title":"Source","type":"link","url":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Sources\/AsyncAlgorithms\/Merge\/AsyncMerge2Sequence.swift","identifier":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Sources\/AsyncAlgorithms\/Merge\/AsyncMerge2Sequence.swift"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Joined":{"title":"Joined","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Joined","url":"\/documentation\/asyncalgorithms\/joined","abstract":[],"kind":"article"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Lazy":{"title":"AsyncSyncSequence","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Lazy","url":"\/documentation\/asyncalgorithms\/lazy","abstract":[{"type":"text","text":"This operation is available for all "},{"code":"Sequence","type":"codeVoice"},{"type":"text","text":" types."}],"kind":"article"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Chain":{"title":"Chain","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Chain","url":"\/documentation\/asyncalgorithms\/chain","abstract":[{"type":"text","text":"Chains two or more asynchronous sequences together sequentially."}],"kind":"article"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/RemoveDuplicates":{"title":"RemoveDuplicates","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/RemoveDuplicates","url":"\/documentation\/asyncalgorithms\/removeduplicates","abstract":[],"kind":"article"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Debounce":{"title":"Debounce","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Debounce","url":"\/documentation\/asyncalgorithms\/debounce","abstract":[],"kind":"article"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Collections":{"title":"Collection Initializers","type":"topic","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Collections","url":"\/documentation\/asyncalgorithms\/collections","abstract":[],"kind":"article"},"https://github.com/apple/swift-async-algorithms/blob/main/Sources/AsyncAlgorithms/Merge/AsyncMerge3Sequence.swift":{"titleInlineContent":[{"text":"Source","type":"text"}],"title":"Source","type":"link","url":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Sources\/AsyncAlgorithms\/Merge\/AsyncMerge3Sequence.swift","identifier":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Sources\/AsyncAlgorithms\/Merge\/AsyncMerge3Sequence.swift"},"https://github.com/apple/swift-async-algorithms/blob/main/Tests/AsyncAlgorithmsTests/TestMerge.swift":{"titleInlineContent":[{"text":"Tests","type":"text"}],"title":"Tests","type":"link","url":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Tests\/AsyncAlgorithmsTests\/TestMerge.swift","identifier":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Tests\/AsyncAlgorithmsTests\/TestMerge.swift"}}}