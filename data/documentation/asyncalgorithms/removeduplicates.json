{"primaryContentSections":[{"content":[{"anchor":"overview","type":"heading","text":"Overview","level":2},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Author(s): "},{"isActive":true,"type":"reference","identifier":"https:\/\/github.com\/kperryua"}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"text","text":"["},{"type":"text","text":" "},{"isActive":true,"type":"reference","identifier":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Sources\/AsyncAlgorithms\/AsyncRemoveDuplicatesSequence.swift"},{"type":"text","text":" |"},{"type":"text","text":" "},{"isActive":true,"type":"reference","identifier":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Tests\/AsyncAlgorithmsTests\/TestRemoveDuplicates.swift"},{"type":"text","text":" "},{"type":"text","text":"]"}]},{"anchor":"Introduction","type":"heading","text":"Introduction","level":2},{"type":"paragraph","inlineContent":[{"text":"When processing values over time it is definitely possible that the same value may occur in a row. When the distinctness of the presence value is not needed it is useful to consider the values over time that are differing from the last. Particularly this can be expressed as removing duplicate values either in the case as they are directly ","type":"text"},{"code":"Equatable","type":"codeVoice"},{"text":" or by a predicate.","type":"text"}]},{"anchor":"Proposed-Solution","type":"heading","text":"Proposed Solution","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"codeVoice","code":"removeDuplicates()"},{"type":"text","text":" and "},{"type":"codeVoice","code":"removeDuplicates(by:)"},{"type":"text","text":" APIs serve this purpose of removing duplicate values that occur. These algorithms test against the previous value and if the latest iteration of the base "},{"code":"AsyncSequence","type":"codeVoice"},{"type":"text","text":" is the same as the last it invokes "},{"code":"next()","type":"codeVoice"},{"type":"text","text":" again. The resulting "},{"code":"AsyncRemoveDuplicatesSequence","type":"codeVoice"},{"type":"text","text":" will ensure that no duplicate values occur next to each other. This should not be confused with only emitting unique new values; where each value is tested against a collected set of values."}]},{"syntax":"swift","code":["extension AsyncSequence where Element: Equatable {","  public func removeDuplicates() -> AsyncRemoveDuplicatesSequence<Self>","}","","extension AsyncSequence {","  public func removeDuplicates(","    by predicate: @escaping @Sendable (Element, Element) async -> Bool","  ) -> AsyncRemoveDuplicatesSequence<Self>","  ","  public func removeDuplicates(","    by predicate: @escaping @Sendable (Element, Element) async throws -> Bool","  ) -> AsyncThrowingRemoveDuplicatesSequence<Self>","}"],"type":"codeListing"},{"inlineContent":[{"text":"The ","type":"text"},{"type":"codeVoice","code":"removeDuplicates"},{"text":" family comes in three variants. One variant is conditional upon the ","type":"text"},{"type":"codeVoice","code":"Element"},{"type":"text","text":" type being "},{"type":"codeVoice","code":"Equatable"},{"type":"text","text":". This variation is a shorthand for writing "},{"type":"codeVoice","code":".removeDuplicates { $0 == $1 }"},{"type":"text","text":". The next variation is the closure version that allows for custom predicates to be applied. This algorithm allows for the cases where the elements themselves may not be equatable but portions of the element may be compared. Lastly is the variation that allows for comparison when the comparison method may throw."}],"type":"paragraph"},{"level":2,"type":"heading","text":"Detailed Design","anchor":"Detailed-Design"},{"inlineContent":[{"type":"text","text":"In the cases where the "},{"type":"codeVoice","code":"Element"},{"text":" type is ","type":"text"},{"type":"codeVoice","code":"Equatable"},{"text":" or the non-trowing predicate variant these utilize the type ","type":"text"},{"type":"codeVoice","code":"AsyncRemoveDuplicatesSequence"},{"text":". The throwing predicate variant uses ","type":"text"},{"type":"codeVoice","code":"AsyncThrowingRemoveDuplicatesSequence"},{"text":". Both of these types are conditionally ","type":"text"},{"type":"codeVoice","code":"Sendable"},{"text":" when the base, base element, and base iterator are ","type":"text"},{"type":"codeVoice","code":"Sendable"}],"type":"paragraph"},{"inlineContent":[{"text":"The ","type":"text"},{"code":"AsyncRemoveDuplicatesSequence","type":"codeVoice"},{"text":" will rethrow if the base asynchronous sequence throws and will not throw if the base asynchronous sequence does not throw.","type":"text"}],"type":"paragraph"},{"code":["public struct AsyncRemoveDuplicatesSequence<Base: AsyncSequence>: AsyncSequence {","  public typealias Element = Base.Element","","  public struct Iterator: AsyncIteratorProtocol {","    public mutating func next() async rethrows -> Element?","  }","","  public func makeAsyncIterator() -> Iterator {","    Iterator(iterator: base.makeAsyncIterator(), predicate: predicate)","  }","}","","extension AsyncRemoveDuplicatesSequence: Sendable ","  where Base: Sendable, Base.Element: Sendable, Base.AsyncIterator: Sendable { }","  ","extension AsyncRemoveDuplicatesSequence.Iterator: Sendable ","  where Base: Sendable, Base.Element: Sendable, Base.AsyncIterator: Sendable { }",""],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"text":"The ","type":"text"},{"code":"AsyncThrowingRemoveDuplicatesSequence","type":"codeVoice"},{"text":" will rethrow if the base asynchronous sequence throws and still may throw if the base asynchronous sequence does not throw due to the predicate having the potential of throwing.","type":"text"}],"type":"paragraph"},{"code":["","public struct AsyncThrowingRemoveDuplicatesSequence<Base: AsyncSequence>: AsyncSequence {","  public typealias Element = Base.Element","  ","  public struct Iterator: AsyncIteratorProtocol {","    public mutating func next() async throws -> Element?","  }","  ","  public func makeAsyncIterator() -> Iterator","}","","extension AsyncThrowingRemoveDuplicatesSequence: Sendable ","  where Base: Sendable, Base.Element: Sendable, Base.AsyncIterator: Sendable { }","  ","extension AsyncThrowingRemoveDuplicatesSequence.Iterator: Sendable ","  where Base: Sendable, Base.Element: Sendable, Base.AsyncIterator: Sendable { }",""],"type":"codeListing","syntax":"swift"},{"text":"Alternatives Considered","type":"heading","level":2,"anchor":"Alternatives-Considered"},{"inlineContent":[{"text":"An alternative algorithm for uniqueness was considered but was discounted since it does not directly belong to this particular family of methods.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"The name of this method could be considered to belong to the ","type":"text"},{"code":"filter","type":"codeVoice"},{"text":" family and could refer directly to the repetitions. There is distinct merit to considering the name to be ","type":"text"},{"code":"filterRepetitions","type":"codeVoice"},{"text":" or ","type":"text"},{"code":"removeRepetitions","type":"codeVoice"},{"text":". Likewise the terminology of ","type":"text"},{"code":"drop","type":"codeVoice"},{"text":" also has merit.","type":"text"}],"type":"paragraph"},{"text":"Credits\/Inspiration","type":"heading","level":2,"anchor":"CreditsInspiration"},{"inlineContent":[{"type":"text","text":"The Combine framework has a "},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/combine\/publisher\/removeduplicates()\/","isActive":true},{"type":"text","text":" that performs a similar task."}],"type":"paragraph"}],"kind":"content"}],"identifier":{"url":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/RemoveDuplicates","interfaceLanguage":"swift"},"kind":"article","metadata":{"roleHeading":"Article","role":"article","title":"RemoveDuplicates","modules":[{"name":"AsyncAlgorithms"}]},"variants":[{"paths":["\/documentation\/asyncalgorithms\/removeduplicates"],"traits":[{"interfaceLanguage":"swift"}]}],"sections":[],"hierarchy":{"paths":[["doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms"]]},"schemaVersion":{"patch":0,"minor":3,"major":0},"seeAlsoSections":[{"identifiers":["doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/AdjacentPairs","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/BufferedBytes","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Chain","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Channel","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Chunked","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Collections","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/CombineLatest","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Compacted","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Debounce","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Effects","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Intersperse","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Joined","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Lazy","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Merge","doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Reductions"],"generated":true,"anchor":"Getting-Started","title":"Getting Started"}],"references":{"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Lazy":{"title":"AsyncSyncSequence","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Lazy","kind":"article","url":"\/documentation\/asyncalgorithms\/lazy","role":"article","type":"topic","abstract":[{"type":"text","text":"This operation is available for all "},{"type":"codeVoice","code":"Sequence"},{"type":"text","text":" types."}]},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/CombineLatest":{"title":"Combine Latest","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/CombineLatest","kind":"article","url":"\/documentation\/asyncalgorithms\/combinelatest","role":"article","type":"topic","abstract":[{"type":"text","text":"Combines the latest values produced from two or more asynchronous sequences into an asynchronous sequence of tuples."}]},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Reductions":{"title":"Reductions","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Reductions","kind":"article","url":"\/documentation\/asyncalgorithms\/reductions","role":"article","type":"topic","abstract":[]},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Merge":{"role":"article","abstract":[{"text":"Merges two or more asynchronous sequences sharing the same element type into one singular asynchronous sequence.","type":"text"}],"type":"topic","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Merge","url":"\/documentation\/asyncalgorithms\/merge","kind":"article","title":"Merge"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/AdjacentPairs":{"url":"\/documentation\/asyncalgorithms\/adjacentpairs","type":"topic","title":"AdjacentPairs","abstract":[],"kind":"article","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/AdjacentPairs"},"https://developer.apple.com/documentation/combine/publisher/removeduplicates()/":{"titleInlineContent":[{"type":"text","text":"function for publishers"}],"type":"link","title":"function for publishers","identifier":"https:\/\/developer.apple.com\/documentation\/combine\/publisher\/removeduplicates()\/","url":"https:\/\/developer.apple.com\/documentation\/combine\/publisher\/removeduplicates()\/"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Compacted":{"title":"Compacted","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Compacted","kind":"article","url":"\/documentation\/asyncalgorithms\/compacted","role":"article","type":"topic","abstract":[]},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms":{"identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms","kind":"symbol","role":"collection","url":"\/documentation\/asyncalgorithms","title":"AsyncAlgorithms","abstract":[{"type":"strong","inlineContent":[{"text":"Swift Async Algorithms","type":"text"}]},{"type":"text","text":" is an open-source package of asynchronous sequence and advanced algorithms that involve concurrency, along with their related types."}],"type":"topic"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Debounce":{"title":"Debounce","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Debounce","kind":"article","url":"\/documentation\/asyncalgorithms\/debounce","role":"article","type":"topic","abstract":[]},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/BufferedBytes":{"title":"AsyncBufferedByteIterator","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/BufferedBytes","kind":"article","url":"\/documentation\/asyncalgorithms\/bufferedbytes","role":"article","type":"topic","abstract":[{"type":"text","text":"Provides a highly efficient iterator useful for iterating byte sequences derived from asynchronous read functions."}]},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Channel":{"url":"\/documentation\/asyncalgorithms\/channel","type":"topic","title":"Channel","abstract":[],"kind":"article","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Channel"},"https://github.com/kperryua":{"titleInlineContent":[{"type":"text","text":"Kevin Perry"}],"identifier":"https:\/\/github.com\/kperryua","title":"Kevin Perry","type":"link","url":"https:\/\/github.com\/kperryua"},"https://github.com/apple/swift-async-algorithms/blob/main/Tests/AsyncAlgorithmsTests/TestRemoveDuplicates.swift":{"type":"link","identifier":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Tests\/AsyncAlgorithmsTests\/TestRemoveDuplicates.swift","title":"Tests","url":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Tests\/AsyncAlgorithmsTests\/TestRemoveDuplicates.swift","titleInlineContent":[{"type":"text","text":"Tests"}]},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Chunked":{"title":"Chunked","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Chunked","kind":"article","url":"\/documentation\/asyncalgorithms\/chunked","role":"article","type":"topic","abstract":[]},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Intersperse":{"title":"Intersperse","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Intersperse","kind":"article","url":"\/documentation\/asyncalgorithms\/intersperse","role":"article","type":"topic","abstract":[{"type":"text","text":"Places a given value in between each element of the asynchronous sequence."}]},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Collections":{"url":"\/documentation\/asyncalgorithms\/collections","type":"topic","title":"Collection Initializers","abstract":[],"kind":"article","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Collections"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Effects":{"url":"\/documentation\/asyncalgorithms\/effects","type":"topic","title":"Effects","abstract":[{"text":"Lists the effects of all async algorithms.","type":"text"}],"kind":"article","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Effects"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Chain":{"url":"\/documentation\/asyncalgorithms\/chain","type":"topic","title":"Chain","abstract":[{"text":"Chains two or more asynchronous sequences together sequentially.","type":"text"}],"kind":"article","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Chain"},"doc://AsyncAlgorithms/documentation/AsyncAlgorithms/Joined":{"title":"Joined","url":"\/documentation\/asyncalgorithms\/joined","type":"topic","abstract":[],"kind":"article","role":"article","identifier":"doc:\/\/AsyncAlgorithms\/documentation\/AsyncAlgorithms\/Joined"},"https://github.com/apple/swift-async-algorithms/blob/main/Sources/AsyncAlgorithms/AsyncRemoveDuplicatesSequence.swift":{"identifier":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Sources\/AsyncAlgorithms\/AsyncRemoveDuplicatesSequence.swift","titleInlineContent":[{"type":"text","text":"Source"}],"url":"https:\/\/github.com\/apple\/swift-async-algorithms\/blob\/main\/Sources\/AsyncAlgorithms\/AsyncRemoveDuplicatesSequence.swift","title":"Source","type":"link"}}}