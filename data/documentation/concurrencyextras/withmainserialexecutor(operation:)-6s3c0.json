{"schemaVersion":{"major":0,"patch":0,"minor":3},"hierarchy":{"paths":[["doc:\/\/ConcurrencyExtras\/documentation\/ConcurrencyExtras"]]},"metadata":{"symbolKind":"func","roleHeading":"Function","modules":[{"name":"ConcurrencyExtras"}],"title":"withMainSerialExecutor(operation:)","role":"symbol","externalID":"s:17ConcurrencyExtras22withMainSerialExecutor9operationyyyYaKYAXE_tYaKF","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"withMainSerialExecutor"},{"kind":"text","text":"("},{"kind":"externalParam","text":"operation"},{"kind":"text","text":": () "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","preciseIdentifier":"s:s4Voida","text":"Void"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"rethrows"}]},"abstract":[{"type":"text","text":"Perform an operation on the main serial executor."}],"sections":[],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/concurrencyextras\/withmainserialexecutor(operation:)-6s3c0"]}],"kind":"symbol","primaryContentSections":[{"kind":"declarations","declarations":[{"tokens":[{"kind":"attribute","text":"@"},{"kind":"attribute","preciseIdentifier":"s:ScM","text":"MainActor"},{"kind":"text","text":" "},{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"withMainSerialExecutor"},{"kind":"text","text":"("},{"kind":"externalParam","text":"operation"},{"kind":"text","text":": @isolated(any) () "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","preciseIdentifier":"s:s4Voida","text":"Void"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"rethrows"}],"languages":["swift"],"platforms":["macOS"]}]},{"kind":"parameters","parameters":[{"name":"operation","content":[{"inlineContent":[{"type":"text","text":"An operation to be performed on the main serial executor."}],"type":"paragraph"}]}]},{"content":[{"level":2,"type":"heading","text":"Discussion","anchor":"discussion"},{"type":"paragraph","inlineContent":[{"text":"Some asynchronous code is ","type":"text"},{"isActive":true,"identifier":"https:\/\/forums.swift.org\/t\/reliably-testing-code-that-adopts-swift-concurrency\/57304","type":"reference"},{"text":" ","type":"text"},{"text":"to test in Swift due to how suspension points are processed by the runtime. This function","type":"text"},{"text":" ","type":"text"},{"text":"attempts to run all tasks spawned in the given operation serially and deterministically. It","type":"text"},{"text":" ","type":"text"},{"text":"makes asynchronous tests faster and less flakey.","type":"text"}]},{"code":["await withMainSerialExecutor {","  \/\/ Everything performed in this scope is performed serially...","}"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"See ","type":"text"},{"isActive":true,"identifier":"doc:\/\/ConcurrencyExtras\/documentation\/ConcurrencyExtras\/ReliablyTestingAsync","type":"reference"},{"text":" for more information on why this tool is needed to test","type":"text"},{"text":" ","type":"text"},{"text":"async code and how to use it.","type":"text"}]},{"name":"Warning","content":[{"inlineContent":[{"type":"text","text":"This API is only intended to be used from tests to make them more reliable. Please do"},{"type":"text","text":" "},{"type":"text","text":"not use it from application code."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"We say that it “"},{"inlineContent":[{"type":"text","text":"attempts"}],"type":"emphasis"},{"type":"text","text":" to run all tasks spawned in an operation serially and"},{"type":"text","text":" "},{"type":"text","text":"deterministically” because under the hood it relies on a global, mutable variable in the Swift"},{"type":"text","text":" "},{"type":"text","text":"runtime to do its job, and there are no scoping "},{"inlineContent":[{"type":"text","text":"guarantees"}],"type":"emphasis"},{"type":"text","text":" should this mutable variable change"},{"type":"text","text":" "},{"type":"text","text":"during the operation."}],"type":"paragraph"}],"type":"aside","style":"warning"}],"kind":"content"}],"identifier":{"url":"doc:\/\/ConcurrencyExtras\/documentation\/ConcurrencyExtras\/withMainSerialExecutor(operation:)-6s3c0","interfaceLanguage":"swift"},"references":{"https://forums.swift.org/t/reliably-testing-code-that-adopts-swift-concurrency/57304":{"url":"https:\/\/forums.swift.org\/t\/reliably-testing-code-that-adopts-swift-concurrency\/57304","titleInlineContent":[{"type":"text","text":"notoriously"},{"type":"text","text":" "},{"type":"text","text":"difficult"}],"identifier":"https:\/\/forums.swift.org\/t\/reliably-testing-code-that-adopts-swift-concurrency\/57304","type":"link","title":"notoriously difficult"},"doc://ConcurrencyExtras/documentation/ConcurrencyExtras/ReliablyTestingAsync":{"url":"\/documentation\/concurrencyextras\/reliablytestingasync","type":"topic","title":"Reliably testing async code","role":"article","abstract":[{"type":"text","text":"Learn how to use the tools of this library to write reliable, deterministic tests for your async"},{"type":"text","text":" "},{"type":"text","text":"Swift code."}],"kind":"article","identifier":"doc:\/\/ConcurrencyExtras\/documentation\/ConcurrencyExtras\/ReliablyTestingAsync"},"doc://ConcurrencyExtras/documentation/ConcurrencyExtras":{"url":"\/documentation\/concurrencyextras","type":"topic","title":"ConcurrencyExtras","role":"collection","abstract":[{"type":"text","text":"Useful, testable Swift concurrency."}],"kind":"symbol","identifier":"doc:\/\/ConcurrencyExtras\/documentation\/ConcurrencyExtras"},"doc://ConcurrencyExtras/documentation/ConcurrencyExtras/withMainSerialExecutor(operation:)-6s3c0":{"url":"\/documentation\/concurrencyextras\/withmainserialexecutor(operation:)-6s3c0","type":"topic","title":"withMainSerialExecutor(operation:)","role":"symbol","abstract":[{"type":"text","text":"Perform an operation on the main serial executor."}],"kind":"symbol","identifier":"doc:\/\/ConcurrencyExtras\/documentation\/ConcurrencyExtras\/withMainSerialExecutor(operation:)-6s3c0","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"withMainSerialExecutor"},{"kind":"text","text":"("},{"kind":"externalParam","text":"operation"},{"kind":"text","text":": () "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Void","preciseIdentifier":"s:s4Voida"},{"kind":"text","text":") "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"rethrows"}]}}}